<main>
  <ng-container *ngIf="(mensagens$ | async) as mensagens; else nenhumaMensagemEncontrada">
    <ng-container *ngIf="mensagens.length > 0; else nenhumaMensagemEncontrada">
      <table mat-table [dataSource]="mensagens$" class="mat-elevation-z8">
        <ng-container matColumnDef="titulo">
          <th mat-header-cell *matHeaderCellDef>Título</th>
          <td mat-cell *matCellDef="let mensagem">{{mensagem.titulo}}</td>
        </ng-container>

        <ng-container matColumnDef="mensagem">
          <th mat-header-cell *matHeaderCellDef>Mensagem</th>
          <td mat-cell *matCellDef="let mensagem">{{mensagem.mensagem}}</td>
        </ng-container>

        <ng-container matColumnDef="tipo">
          <th mat-header-cell *matHeaderCellDef>Tipo</th>
          <td mat-cell *matCellDef="let mensagem">{{mensagem.tipoMensagem}}</td>
        </ng-container>

        <ng-container matColumnDef="dataCriacao">
          <th mat-header-cell *matHeaderCellDef>Data de Crição</th>
          <td mat-cell *matCellDef="let mensagem">{{mensagem.dataCriacao}}</td>
        </ng-container>

        <ng-container matColumnDef="acoes">
          <th mat-header-cell *matHeaderCellDef>Ações</th>
          <td mat-cell *matCellDef="let mensagem">
            <button mat-button color="primary" (click)="lerMensagem(mensagem)">Ler</button>
            <button mat-button color="primary" (click)="excluirMensagem(mensagem)">Excluir</button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"
            [ngClass]="{'critico': row.tipoMensagem === 'CRITICA',
              'alerta': row.tipo === 'ALERTA',
              'informacao': row.tipo === 'INFORMACAO'}">
        </tr>

      </table>
    </ng-container>
  </ng-container>

  <ng-template #nenhumaMensagemEncontrada>
    <section fxLayout="row" fxLayoutAlign="center center">
      <section fxLayout="column" fxLayoutGap="1rem" fxFlex.gt-md="30">
        <h2>Tudo certo por aqui. Nenhuma mensagem encontrada!</h2>
      </section>
    </section>
  </ng-template>
</main>
